
<p>The issue reporting API is used by applications for sending service requests to the City of Helsinki.</p>

<p>At the moment, the API is mostly used for sending service requests about broken parts of city infrastructure like street signs, potholes, etc. These kinds of service requests are typically handled by <a href="http://www.hel.fi/wps/portal/Rakennusvirasto_en/?">the Public Works Department</a>. However, the API is increasingly used for other types of feedback as well.</p>

<p>The API enables its clients to:</p>

<ol>
  <li>Submit new service requests</li>
  <li>Query individual or multiple service requests and their descriptions and statuses</li>
  <li>List service request types and definitions of additional attributes</li>
</ol>

<p>The Issue Reporting API is based on GeoReport API version 2, better known as the <a href="http://open311.org">Open311 specification</a>. The interface is designed in such a way that any GeoReport v2 compatible client is able to use the interface. This interface is compliant with <a href="http://www.citysdk.eu/">CitySDK</a> specific enhancements to Open311 and parameters specific to it are marked <FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT>.</p>

<h2><a id="Helsinki specific" name="Helsinki specific">
  Helsinki specific details</a></h2>

<h3>API keys and testing</h3>

<p>Client applications submitting new service requests to the feedback system will need an API key. None of the other methods require an API key.</p>

<p>The City of Helsinki has a separate environment and URL for testing developer applications (<a href="http://dev.hel.fi/open311-test/v1/discovery.json">test system</a>) before connecting them to the production system (<strong>https://asiointi.hel.fi/palautews/rest/v1/</strong>). The API key developers use in the test environment is different than the one used in production. The standard developer workflow goes like this:</p>

<ol>
  <li>The developer requests an API key for the test system.</li>
  <li>Using the test API key, the developer implements and tests their client against the test system.</li>
  <li>The developer requests an API key for the production system. After city personnel has verified that the client conforms to the API terms, the production API key is created and given to the developer. Reserve 1-2 weeks for the verification.</li>
  <li>The developer's application is deployed using the production system API key and is tested against the production system.</li>
</ol>

<p>The use of API is subject to following terms: <a href="http://dev.hel.fi/issuereporting/tos">Terms of Service</a> /  <a href="http://dev.hel.fi/palaute/lisenssijakayttoehdot">Käyttöehdot ja lisenssi</a>.</p>
<p>For test and production system API keys contact Timo Tuominen, timo.tuominen@hel.fi, +358 9 310 25495.</p>

<h3>Encoding and formats</h3>

<p>UTF-8 is required everywhere. The API supports both XML and JSON.</p>

<h3>Language support</h3>

<p>Finnish and English are supported. In practice, this means that the service request types (<a href="#GET Service List">GET Service List</a>) can be queried by those languages.</p>

<h2><a id="API Methods" name="API Methods">API Methods</a></h2>

<h3><a id="GET Service List" name="GET Service List">GET Service List</a></h3>

<p>Provides a list of acceptable service request types and their associated service codes.</p>

<ul>
  <li>URL address: https://asiointi.hel.fi/palautews/rest/v1/services.[format].</li>
  <li>Example URL: https://asiointi.hel.fi/palautews/rest/v1/services.json</li>
  <li>Requires API key: No</li>
  <li>Method: GET</li>
</ul>

<p><strong>Request Parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>locale</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Preferred language</td>
      <td>No</td>
      <td>
      <p>Locales can be, for example, fi, fi_FI, en, en_GB or en_US. If no locale is given the default value is English.</p>
      </td>
    </tr>
  </tbody>
</table>

<p><strong>&nbsp;Response parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_code</strong></td>
      <td>The unique identifier for the service request type</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_name</strong></td>
      <td>The human readable name of the service request type</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td>A brief description of the service request type.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>metadata</strong></td>
      <td>
      <p>Determines whether there are additional form fields for this service type.</p>
      <ul>
        <li>true: This service request type requires additional metadata so the client will need to make a call to the <a href="http://wiki.open311.org/GeoReport_v2.1_Draft#GET_Service_Definition">Service Definition</a> method.</li>
        <li>false: No additional information is required and a call to the <a href="http://wiki.open311.org/GeoReport_v2.1_Draft#GET_Service_Definition">Service Definition</a> method is not needed.</li>
      </ul>
      </td>
      <td>Yes</td>
      <td>At the moment metadata is always set to false.</td>
    </tr>
    <tr>
      <td><strong>type</strong></td>
      <td>
      <p>realtime: The service request ID will be returned immediately after the service request is submitted.</p>
      </td>
      <td>Yes</td>
      <td>At the moment, type is always set to realtime.</td>
    </tr>
    <tr>
      <td><strong>keywords</strong></td>
      <td>A comma separated list of tags or keywords to help users identify the request type. This can provide synonyms of the service_name and group.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>group</strong></td>
      <td>A category to group this service type within. This provides a way to group several service request types under one category such as "sanitation"</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>

<p><strong>Possible errors</strong></p>

<p>The numbers represent the HTTP status code returned for each error type:</p>

<ul>
  <li>400 - General Service Error (Any failure during create request processing, eg CRM is down. Client will need to notify us)</li>
</ul>

<p><strong>Example request:</strong></p>

<p><a href="https://asiointi.hel.fi/palautews/rest/v1/services.json?locale=fi_FI">https://asiointi.hel.fi/palautews/rest/v1/services.json?locale=fi_FI</a></p>

<p><strong>Example response:</strong></p>

<pre class="brush: js">
[ 
  {
    "service_code": "246",
    "service_name": "Roskaaminen",
    "description": "Ilmoita, jos havaitset suuria määriä roskia yleisillä alueilla, puistoissa tai metsissä.",
    "metadata": false,
    "type": "realtime",
    "keywords": "roska,jäte",
    "group": "Puhtaanapito"
   },
   {
    "service_code": "176",
    "service_name": "Töhryjen poisto",
    "description": "Ilmoita, jos paikkoja tai seiniä on töhritty.",
    "metadata": false,
    "type": "realtime",
    "keywords": "roska,jäte",
    "group": "Puhtaanapito"
    }
 ]
</pre>

<h3><a id="GET Service Definition" name="GET Service Definition">GET Service Definition</a></h3>

<p>Define attributes associated with a service code. At the moment, there are no attributes defined in Helsinki API and therefore no use for this method.</p>

<ul>
  <li>URL address: https://asiointi.hel.fi/palautews/rest/v1/services/[service code].[format].</li>
  <li>Example URL: https://asiointi.hel.fi/palautews/rest/v1/services/246.json</li>
  <li>Requires API key: No</li>
  <li>Method: GET</li>
</ul>

<p><strong>Request parameters</strong></p>

<table border="1" cellpadding="1" cellspacing="1" style="width:800px">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_code</strong></td>
      <td>The unique identifier for the service request type.</td>
      <td>Yes</td>
      <td>The service_code is specified in the main URL path rather than an added query string parameter.</td>
    </tr>
    <tr>
      <td><strong>locale</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Preferred language</td>
      <td>No</td>
      <td>Locales can be, for example, fi, fi_FI, en, en_GB or en_US. If no locale is given the default value is English.</td>
    </tr>
  </tbody>
</table>

<p><strong>Response parameters</strong></p>

<p>TODO</p>

<h3><a id="POST Service Request" name="POST Service Request">POST Service Request</a></h3>

<p>This method is used for sending service requests to the city's feedback system.</p>

<ul>
  <li>URL: https://asiointi.hel.fi/palautews/rest/v1/requests.[format]</li>
  <li>Example URL: https://asiointi.hel.fi/palautews/rest/v1/requests.json</li>
  <li>Posting formats: Content-Type application/x-www-form-urlencoded or multipart/form-data</li>
  <li>Requires API key: YES</li>
  <li>HTTP Method POST</li>
</ul>

<p><strong>Request parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>api_key</strong></td>
      <td>Api key for submitting service requests</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_code</strong></td>
      <td>The unique identifier for the service request type</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td>A full description of the service request.</td>
      <td>Yes</td>
      <td>This is free form text having min 10 and max 5,000 characters. This may contain line breaks, but not html or code. </td>
    </tr>
      <tr>
      <td>
        <p><strong>title</strong></p>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p>
      </td>
      <td>Title of the service requests</td>
      <td>No</td>
      <td></td>
    </tr>  
    <tr>
      <td><strong>lat</strong></td>
      <td>Latitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>No</td>
      <td>
      <p>Currently all service types require location, either lat/long or service_object_id.</p>
      </td>
    </tr>
    <tr>
      <td><strong>long</strong></td>
      <td>Longitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>No</td>
      <td>Currently all service types require location, either lat/long or service_object_id.</td>
    </tr>
    <tr>
      <td>
      <p><strong>service_object_type</strong></p>
      <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p>
      </td>
      <td>Describes the point of interest reference which is used for identifying the request object.</td>
      <td>No</td>
      <td>If service_object_id is included in the request, then service_object_type must be included.</td>
    </tr>
    <tr>
      <td>
      <p><strong>service_object_id</strong></p>
      <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p>
      </td>
      <td>Describes the point of interest reference which is used for identifying the request object.</td>
      <td>No</td>
      <td>If service_object_id is included in the request, then service_object_type must be included.</td>
    </tr>
    <tr>
      <td><strong>address_string</strong></td>
      <td>Human readable address or description of the location.</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>email</strong></td>
      <td>The email address of the person submitting the request</td>
      <td>No</td>
      <td>If email address is given, service will notify the email address when service request is processed.</td>
    </tr>
    <tr>
      <td><strong>first_name</strong></td>
      <td>The given name of the person submitting the request</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>last_name</strong></td>
      <td>The family name of the person submitting the request</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>phone</strong></td>
      <td>The phone number of the person submitting the request</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>media_url</strong></td>
      <td>A URL to media associated with the request, e.g. an image</td>
      <td>No</td>
      <td>API supports the most typical media formats like  jpg, png, gif,.. Note, that URL links must end with a correct filetype like ".jpg", e.g. http://pbs.twimg.com/media/Ay9wUStCEAEtoPC.jpg. Https URLs are not supported at moment.</td>
    </tr>
    <tr>
      <td><strong>media</strong></td>
      <td>Array of file uploads</td>
      <td>No</td>
      <td>
      <p>A client may POST multiple files as multipart/form-data. This is the equivalent of having multiple &lt;input type="file" name="media[]" /&gt; inputs. Subsequent calls for GET Service Requests should return the URL for this file via the media_urls field. See more at section <a href="#Uploading media">Uploading media</a>.</p>
      </td>
    </tr>
  </tbody>
</table>

<p><strong>&nbsp;</strong></p>

<p><strong>Response parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_request_id</strong></td>
      <td>The unique ID of the service request created</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_notice</strong></td>
      <td>The human readable name of the service request type</td>
      <td>Yes</td>
      <td>Currently empty string</td>
    </tr>
  </tbody>
</table>

<p><strong>Possible errors</strong></p>

<p>The numbers represent the HTTP status code returned for each error type:</p>

<ul>
  <li>404 - service_code or jurisdiction_id was not found (specified in error response)</li>
  <li>400 - General Service Error. Any failure during create request processing, e.g. API service is down.</li>
</ul>

<p><strong>Example request:</strong></p>

<pre class="brush: xml">
POST /palautews/rest/v1/requests.json
Host: asiointi.hel.fi
Content-Type: application/x-www-form-urlencoded; charset=utf-8

api_key=xyz&amp;service_code=001&amp;lat=37.76524078&amp;long=122.4212043&amp;address_string=Unioninkatu 25
&amp;email=jaakko.rajaniemi%40hel.fi&amp;first_name=Jaakko&amp;last_name=Rajaniemi&amp;phone=111111111&amp;
description=Large+sinkhole+is+destroying+the+street &amp;media_url=http%3A%2F%2Ffarm3.static.flickr.com%2F2002%2F225ed4760.jpg
</pre>

<p><strong>Example response:</strong></p>
<pre class="brush: js">
[
  {
    "service_request_id":"8fmht6g1470b3qk8pthg",
    "service_notice":""
  }
]</pre>

<p>&nbsp;</p>

<h3><a id="GET Service Requests" name="GET Service Requests">GET Service Requests</a></h3>

<p>This method is used to query the current status of multiple requests.</p>

<ul>
  <li>URL: https://[API endpoint]/requests.[format]</li>
  <li>Example URL: https://asiointi.hel.fi/palautews/rest/v1/requests.xml?start_date=2010-05-24T00:00:00Z&amp;end_date=2010-06-24T00:00:00Z&amp;status=open</li>
  <li>HTTP Method GET</li>
</ul>

<p><strong>Request Parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter names</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_request_id</strong></td>
      <td>To call multiple Service Requests at once, multiple service_request_id can be declared; comma delimited.</td>
      <td>No</td>
      <td>This overrides all other arguments.</td>
    </tr>
    <tr>
      <td><strong>service_code</strong></td>
      <td>Specify the service type by calling the unique ID of the service_code.</td>
      <td>No</td>
      <td>This defaults to all service codes when not declared; can be declared multiple times, comma delimited</td>
    </tr>
    <tr>
      <td><strong>start_date</strong></td>
      <td>Earliest requested_datetime to include in the search. When provided with end_date, allows one to search for requests which have a requested_datetime that matches a given range, but may not span more than 90 days.</td>
      <td>No</td>
      <td>Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>end_date</strong></td>
      <td>Latest requested_datetime to include in the search. When provided with start_date, allows one to search for requests which have a requested_datetime that matches a given range, but may not span more than 90 days.</td>
      <td>No</td>
      <td>Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>status</strong></td>
      <td>Allows one to search for requests which have a specific status. This defaults to all statuses; can be declared multiple times, comma delimited.</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>extensions</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>The endpoint provides supplemental details about service requests that are in addition to the ones described in the standard specification. These data are nested in the 'extended_attributes' parameter in the Service Request response. In order to retrieve the new supplemental details, add the query parameter “extensions=true” to the request</td>
      <td>No</td>
      <td>See chapter on <a href="#Extensions">Extensions</a>.</td>
    </tr>
    <tr>
      <td><strong>service_object_type</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Describes the point of interest reference which is used for identifying the request object.</td>
      <td>No</td>
      <td>See chapter on <a href="#Service Objects">Service Objects</a>.</td>
    </tr>
    <tr>
      <td><strong>service_object_id</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Describes the ID of the service object</td>
      <td>No</td>
      <td>If service_object_id is included in the request, then service_object_type must be included.</td>
    </tr>
    <tr>
      <td><strong>lat</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Latitude</td>
      <td>No</td>
      <td>Location based search if lat, long and radius are given.</td>
    </tr>
    <tr>
      <td><strong>long</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Longitude</td>
      <td>No</td>
      <td>Location based search if lat, long and radius are given.</td>
    </tr>
    <tr>
      <td><strong>radius</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Radius (meters) in which location based search performed.</td>
      <td>No</td>
      <td>Location based search if lat, long and radius are given.</td>
    </tr>
    <tr>
      <td><strong>updated_after</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Earliest updated_datetime to include in search. Allows one to search for requests which have an updated_datetime between the updated_after time and updated_before time (or now). This is useful for downloading a changeset that includes changes to older requests or to just query very recent changes.</td>
      <td>No</td>
      <td>Must use w3 format, eg 2010-01-01T00:00:00Z.</td>
    </tr>
<tr>
      <td><strong>updated_before</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></p></td>
      <td>Latest updated_datetime to include in search. Allows one to search for requests which have an updated_datetime between the updated_after time and the updated_before time. This is useful for downloading a changeset that includes changes to older requests or to just query very recent changes. </td>
      <td>No</td>
      <td>When not specified (updated_after is used without updated_before) then updated_before is assumed to be now. Must use w3 format, eg 2010-01-01T00:00:00Z.</td>
    </tr>
  </tbody>
</table>

<p><strong>Response Parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter names</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_request_id</strong></td>
      <td>The unique ID of the service request created.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>status_notes</strong></td>
      <td>
      <p>Explanation of why the status was changed to the current state or more details on the current status than is conveyed with status alone</p>
      </td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>status</strong></td>
      <td>
      <p>The current status of the service request.</p>
      <ul>
        <li>open: it has been reported.</li>
        <li>closed: it has been resolved.</li>
      </ul>
      </td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_code</strong></td>
      <td>The unique identifier for the service request type</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_name</strong></td>
      <td>The human readable name of the service request type</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td>A full description of the request or report submitted.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>agency_responsible</strong></td>
      <td>The agency responsible for fulfilling or otherwise addressing the service request.</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_notice</strong></td>
      <td>Information about the action expected to fulfill the request or otherwise address the information reported.</td>
      <td>No</td>
      <td>Empty string</td>
    </tr>
    <tr>
      <td><strong>requested_datetime</strong></td>
      <td>The date and time when the service request was made.</td>
      <td>No</td>
      <td>Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>updated_datetime</strong></td>
      <td>The date and time when the service request was last modified. For requests with status=closed, this will be the date the request was closed.</td>
      <td>No</td>
      <td>Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>expected_datetime</strong></td>
      <td>The date and time when the service request can be expected to be fulfilled. This may be based on a service-specific service level agreement.</td>
      <td>No</td>
      <td>No available. Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>address</strong></td>
      <td>Human readable address or description of location.</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>lat</strong></td>
      <td>latitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>Yes</td>
      <td>Currently all service types require location, either lat/long or service_object_id.</td>
    </tr>
    <tr>
      <td><strong>long</strong></td>
      <td>longitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>Yes</td>
      <td>Currently all service types require location, either lat/long or service_object_id.</td>
    </tr>
    <tr>
      <td><strong>media_url</strong></td>
      <td>A URL to media associated with the request, eg an image.</td>
      <td>No</td>
      <td>Contains only one of these elements.</td>
    </tr>
    <tr>
      <td><strong>service_object_type</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>
      <p>Nested inside the extended_attributes field (extended_attributes.service_object_type). Describes the point of interest reference which is used for identifying the request object.</p>
      </td>
      <td>No</td>
      <td>See chapter on <a href="#Service Objects">Service Objects. </a></td>
    </tr>
    <tr>
      <td><strong>service_object_id</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested inside the extended_attributes field (extended_attributes.service_object_id). Describes the ID of the service object.</td>
      <td>No</td>
      <td>If service_object_id is included in the request, then service_object_type must be included.</td>
    </tr>
    <tr>
      <td><strong>detailed_status</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested inside the extended_attributes field (extended_attributes.detailed_status). Describes the detailed status of the service request.</td>
      <td>No</td>
      <td>This can contain multiple status values; comma delimited. See more on section <a href="#Detailed status of service requests">Detailed status of service requests</a>.</td>
    </tr>
    <tr>
      <td><strong>media_urls</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested inside the extended_attributes field (extended_attributes.media_urls). Contains URLs to media associated with the request.</td>
      <td>No</td>
      <td>The values is array of strings.</td>
    </tr>
  </tbody>
</table>

<p><strong>Response Volume</strong></p>

<p>The default query limit is a span of 90 days or first 200 requests returned, whichever is smallest.</p>

<p><strong>Possible errors</strong></p>

<p>The numbers represent the HTTP status code returned for each error type:</p>

<ul>
  <li>404 - service_code or jurisdiction_id was not found (specified in error response)</li>
  <li>400 - General Service Error. Any failure during create request processing, e.g. API service is down.</li>
</ul>

<p>&nbsp;</p>

<p><strong>Example Request</strong></p>

<p><a href="https://asiointi.hel.fi/palautews/rest/v1/requests.json?start_date=2013-04-24T00:00:00Z&amp;end_date=2013-05-24T00:00:00Z">https://asiointi.hel.fi/palautews/rest/v1/requests.json?start_date=2013-04-24T00:00:00Z&amp;end_date=2013-05-24T00:00:00Z</a></p>

<p><strong>Example Response</strong></p>

<pre class="brush: js">
[
   {
      "service_request_id": "8fmht6g1470b3qk8pthg",
      "service_code": "171",
      "description": "Itäkeskuksen uimahallin edessä kadulla on monttuja ajotiessä.",
      "service_notice": "",
      "requested_datetime": "2013-05-02T11:02:07+03:00",
      "updated_datetime": "2013-05-02T15:32:29+03:00",
      "status": "open",
      "status_notes": "",
      "agency_responsible": "",
      "service_name": "",
      "address": "",
      "address_id": "",
      "zip_code": "",
      "lat": "60.21263634325148",
      "long": "25.077090230550745"
    },
{
      "service_request_id": "1ju4p6v3e04pcpobfv7u",
      "service_code": "178",
      "description": "Tilapäiset merkit voisi ihan hyvin sijoittaa Lautatarhankatu ja Hämeentie kauppakeskus Arabian kohdalla.",
      "service_notice": "",
      "requested_datetime": "2013-04-30T10:52:55+03:00",
      "updated_datetime": "2013-05-01T14:35:01+03:00",
      "status": "closed",
      "status_notes": "Kiitos ilmoituksestanne. Olen välittänyt asian alueen tarkastajalle, joka valvoo tilapäisiä liikennejärjestelyjä ja kaivauksia.",
      "agency_responsible": "",
      "service_name": "",
      "address": "",
      "address_id": "",
      "zip_code": "",
      "lat": "60.189587726063884",
      "long": "24.966438613848045"
    }
]
</pre>

<p>&nbsp;</p>

<h3><a id="GET Service Request" name="GET Service Request">GET Service Request</a></h3>

<p>This method is used to query the current status of multiple requests.</p>

<ul>
  <li>URL: https://asiointi.hel.fi/palautews/rest/v1/requests/[service_request_id].[format]</li>
  <li>Example URL: https://asiointi.hel.fi/palautews/rest/v1/requests/1ju4p6v3e04pcpobfv7u.json</li>
  <li>HTTP Method GET</li>
</ul>

<p><strong>Request Parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter names</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_request_id</strong></td>
      <td>Unique id of the service request</td>
      <td>Yes</td>
      <td>The service_request_id is specified in the main URL path rather than an added query string parameter.</td>
    </tr>
    <tr>
      <td><strong>extensions</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Helsinki endpoint provides supplemental details about service requests that are in addition to the ones described in the Open311 specification. These data are nested in the 'extended_attributes' field in the response. In order to retrieve the new supplemental details, add the query parameter “extensions=true” to any request.</td>
      <td>No</td>
      <td>
      <p>Options: <strong>true</strong>, <strong>false</strong>. Defaults to false. See more at the <a href="#Extensions">Extensions</a> chapter.</p>
      </td>
    </tr>
  </tbody>
</table>

<p><strong>Response Parameters:</strong></p>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter names</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>service_request_id</strong></td>
      <td>Unique id of the service request</td>
      <td>Yes</td>
      <td>The service_request_id is specified in the main URL path rather than an added query string parameter.</td>
    </tr>
    <tr>
      <td><strong>status_notes</strong></td>
      <td>Explanation of why the status was changed to the current state or more details on the current status than conveyed with status alone.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>service_name</strong></td>
      <td>The human readable name of the service request type</td>
      <td>Yes</td>
      <td>Empty string</td>
    </tr>
    <tr>
      <td><strong>service_code</strong></td>
      <td>The unique identifier for the service request type</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>status</strong></td>
      <td>
      <p>The current status of the service request.</p>

      <ul>
        <li>open: it has been reported.</li>
        <li>closed: it has been resolved.</li>
      </ul>
      </td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td>A full description of the request or report submitted.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>agency_responsible</strong></td>
      <td>The agency responsible for fulfilling or otherwise addressing the service request.</td>
      <td>No</td>
      <td>Empty string</td>
    </tr>
    <tr>
      <td><strong>service_notice</strong></td>
      <td>Information about the action expected to fulfill the request or otherwise address the information reported.</td>
      <td>No</td>
      <td>Empty string</td>
    </tr>
    <tr>
      <td><strong>requested_datetime</strong></td>
      <td>The date and time when the service request was made.</td>
      <td>Yes</td>
      <td>Must use W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>updated_datetime</strong></td>
      <td>The date and time when the service request was last modified. For requests with status=closed, this will be the date the request was closed.</td>
      <td>Yes</td>
      <td>Must use the W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>expected_datetime</strong></td>
      <td>The date and time when the service request can be expected to be fulfilled. This may be based on a service-specific service level agreement.</td>
      <td>No</td>
      <td>Not available. Must use the W3C format, e.g 2010-01-01T00:00:00Z.</td>
    </tr>
    <tr>
      <td><strong>address</strong></td>
      <td>Human readable address or description of location.</td>
      <td>No</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>lat</strong></td>
      <td>latitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>No</td>
      <td>Currently all service types require location, either lat/long or service_object_id.</td>
    </tr>
    <tr>
      <td><strong>long</strong></td>
      <td>longitude using the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">(WGS84)</a> projection.</td>
      <td>No</td>
      <td>Currently all service types require location, either lat/long or service_object_id.</td>
    </tr>
    <tr>
      <td><strong>media_url</strong></td>
      <td>A URL to media associated with the request, for example an image.</td>
      <td>No</td>
      <td>May contain more than one of these elements. <a href="http://dev.hel.fi/?q=node/34">This feature is coming soon.</a></td>
    </tr>
    <tr>
      <td><strong>service_object_type</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td><p>Nested inside the extended_attributes field (extended_attributes.service_object_type). Describes the point of interest reference which is used for identifying the request object.</td>
      <td>No</td>
      <td>See chapter on <a href="#Service Objects">Service Objects. </a></td>
    </tr>
    <tr>
      <td><strong>service_object_id</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested inside the extended_attributes field (extended_attributes.service_object_id) describes the ID of the object e.g. public toiled in Helsinki Esplanade park&nbsp; ID = 10844.</td>
      <td>No</td>
      <td>
      <p>If service_object_id is included, then service_object_type must be also included. See chapter on <a href="#Service Objects">Service Objects.</a></p>
      </td>
    </tr>
    <tr>
      <td><strong>detailed_status</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested in extended_attributes parameters (extended_attributes. detailed_status) describes detailed status of the service request.</td>
      <td>No</td>
      <td>This can contain multiple status values; comma delimited. See more on <a href="#Detailed status of service requests">Detailed status of service requests</a> chapter</td>
    </tr>
    <tr>
      <td><strong>media_urls</strong>
        <p><FONT style="BACKGROUND-COLOR: yellow">CitySDK specific</FONT></td>
      <td>Nested inside the extended_attributes field (extended_attributes.media_urls). Contains URLs to media associated with the request.</td>
      <td>No</td>
      <td>The values is an array of strings.</td>
    </tr>
  </tbody>
</table>

<p><strong>Possible errors</strong></p>

<p>The numbers represent the HTTP status code returned for each error type:</p>

<ul>
  <li>404 - service_code or jurisdiction_id was not found (specified in error response)</li>
  <li>400 - General Service Error. Any failure during create request processing, e.g. API service is down.</li>
</ul>

<p><strong>Example Request</strong></p>

<p><a href="https://asiointi.hel.fi/palautews/rest/v1/requests/8fmht6g1470b3qk8pthg.json?extensions=true">https://asiointi.hel.fi/palautews/rest/v1/requests/8fmht6g1470b3qk8pthg.json?extensions=true</a></p>

<p><strong>Example Response</strong></p>

<pre class="brush: js">
[ 
   {
    "service_request_id": "8fmht6g1470b3qk8pthg",
    "service_code": "171",
    "description": "Itäkeskuksen uimahallin edessä kadulla on monttuja ajotiessä. \n\nLisätietoa: http://metro.fi/paakaupunkiseutu/fiksaus/monttu_tiessa.4/",
    "requested_datetime": "2013-05-02T11:02:07+03:00",
    "updated_datetime": "2013-05-15T08:55:09+03:00",
    "status": "closed",
    "status_notes": "Kiitos ilmoituksestanne. Olemme välittäneet korjauspyynnön alueen katujen kunnossapitoon.\n\nTerveisin\nRakennusviraston asiakaspalvelu\n",
    "lat": "60.21263634325148",
    "long": "25.077090230550745",
    "extended_attributes": {
        "title": "Monttu tiessä",
        "detailed_status": "PROCESSED"
    }
  }
]
</pre>

<h3><a id="Error messages" name="Error messages">Error messages</a></h3>

<table border="1" cellpadding="1" cellspacing="1">
  <thead>
    <tr>
      <th scope="col">Parameter name</th>
      <th scope="col">Description</th>
      <th scope="col">Required</th>
      <th scope="col">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>code</strong></td>
      <td>The error code representing the type of error. In most cases, this should match the HTTP status code returned in the HTTP header.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td>A human readable description of the error that occurred. This is meant to be seen by the end user.</td>
      <td>Yes</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>

<p><strong>General error:</strong></p>

<ul>
  <li>403 – Missing or Invalid API Key (specify in error message)</li>
  <li>400 – The URL request is invalid or service is not running or reachable. Client should notify us after checking URL</li>
</ul>

<p><strong>Example Error</strong></p>

<p>HTTP/1.1 403 Forbidden</p>

<pre class="brush: js">
[
  {
    "code":403,
    "description":"Missing or invalid API key.",
  }
]
</pre>

<h2><a id="Moderation of Service Requests" name="Moderation of Service Requests">Moderation of Service Requests</a></h2>

<p>When a service request is posted to the city's issue reporting system, it is not yet shown publicly in the API's service request listings. Each service request is pre-moderated and only after publishing is the service request visible through the API's listing views.</p>

<p>Before the service request is moderated, the service request details are visible and can be queried by using the service_request_id.</p>

<h2><a id="Service Objects" name="Service Objects">Service Objects</a> (service_object_type, service_object_id)</h2>

<p>A service request may contain a reference to a service point using the field service_object_id. These represent service points 
in the <a href="http://servicemap.hel.fi/">Helsinki metropolitan area service map</a>.</p>

<p>Public toilet in Helsinki service map:</p>

<ul>
  <li>service_object_id=<a href="http://www.hel.fi/palvelukarttaws/rest/v2/unit/10844">10844</a></li>
  <li>service_object_type=http://www.hel.fi/servicemap/v2</li>
</ul>

<h2><a id="Extensions" name="Extensions">Extensions</a> (extended_attributes)</h2>

<p>A set of Helsinki specific extensions are carried nested inside extended_attributes parameter. In order to retrieve the new extended attributes in the response, add the query parameter “extensions=true” to the request. The list of parameters are:</p>

<ul>
  <li><strong>title</strong>, feedback system's human readable title for the service request. The value is same as the title parameter given in <a href="http://dev.hel.fi/apis/issuereporting#POST Service Request">POST Service Request</a> or if not present the title is shortened from description text.</li>
  <li><strong>service_object_id</strong>, see more on <a href="#Service Objects">Service Objects</a> chapter.</li>
  <li><strong>service_object_type</strong>, see more on <a href="#Service Objects">Service Objects</a> chapter.</li>
  <li><strong>detailed_status</strong>, see more at the <a href="#Detailed status of service requests">Detailed status of service requests</a> chapter.</li>
</ul>
<p><strong><Example</strong></p>
<pre class="brush: js">
{
"extended_attributes": { 
    "service_object_id": "10844", 
    "title": "Broken toilet", 
    "service_object_type": "http://www.hel.fi/servicemap/v2", 
    "detailed_status": "PROCESSED"
} 
</pre>

<h2><a id="Detailed status of service requests" name="Detailed status of service requests">Detailed status of service requests</a> (detailed_status)</h2>

<p>The status of each service request is transferred in the status parameter. The parameter can have only values “open” or “closed”. The parameter detailed_status is a comma separated list of the detailed status values of the service request.</p>

<p>The set of detailed status values is:</p>

<ul>
  <li>RECEIVED – the service request has been received but nothing has been done it. The value of the status field is "open".</li>
  <li>IN_PROCESS - the service request has been received and its handling has been started. The value of the status field is "open".</li>
  <li>PROCESSED - the service request has been resolved. The value of the status field is "closed".</li>
  <li>ARCHIVED - the service request has been resolved and archived. The value of the status field is "closed". (Not used in Helsinki)</li>
  <li>REJECTED - the service request has been rejected. The value of the status field is "closed". (Not used in Helsinki)</li>
</ul>

If a service request is forwarded to the Public Works Department's Aspa system, its Aspa status is included in the detailed_status parameter. It can have following values:
<ul>
  <li>PUBLIC_WORKS_NEW – the service request has been received but nothing has been done to it.</li>
  <li>PUBLIC_WORKS_IN_PROGRESS - the service request is being handled by the Public Works Department.</li>
  <li>PUBLIC_WORKS_COMPLETED - the service request has been resolved.</li>
  <li>PUBLIC_WORKS_COMPLETED_SCHEDULED_LATER - the service request has been resolved and scheduled to be completed later.</li>
  <li>PUBLIC_WORKS_COMPLETED_REQUIRES_NO_ACTION - the service request requires no action.</li>
  <li>PUBLIC_WORKS_INTERRUPTED - the service request has been interrupted and no action has been taken.</li>
</ul>
 
Example response:
<pre class="brush: js">
{
"extended_attributes": {  
    "detailed_status": "IN_PROCESS,PUBLIC_WORKS_NEW"
} 
</pre>

<h2><a id="Uploading media" name="Uploading media">Uploading media</a></h2>

Uploading of media files like images is supported in two ways. POSTing a Service Request can reference an image with the media_url parameter or a media file can be uploaded directly as multipart/form-data. 

More than one image is supported. If applications send more than one image, special care should be taken on the application side because of the long upload time. It is also possible to upload using the media_url reference and directly multipart/form-data in one shot.

<p><strong>Example of uploading image as multipart/form-data</strong></p>

<pre class="brush: xml">
POST /dev/v2/requests.json
Host: api.hel.fi
Content-Type: multipart/form-data; boundary=AaB03x

--AaB03x
Content-Disposition: form-data; name="api_key"

xyzfskldlkfh823y49823
--AaB03x
Content-Disposition: form-data; name="service_code "

001
--AaB03x
Content-Disposition: form-data; name="lat"

60.168569
--AaB03x
Content-Disposition: form-data; name="lon"

24.950627
--AaB03x
Content-Disposition: form-data; name="description"

There is a huge pothole in her
--AaB03x
Content-Disposition: form-data; name="first_name "

John
--AaB03x<br />
Content-Disposition: form-data; name="last_name "

Smith
--AaB03x
Content-Disposition: form-data; name="phone"

0503391387
--AaB03x
Content-Disposition: form-data; name="email"

john.smith@gmail.com
--AaB03x
Content-Disposition: form-data; name="media[]"; filename="image.gif"
Content-Type: image/gif
Content-Transfer-Encoding: binary

...contents of image.gif...
--AaB03x</p>
</pre>

<p><strong>Example response</strong></p>

<pre class="brush: js">
[
    {
        "service_request_id": "2g8rlg8ricmctfo21agm",
        "service_notice": ""
    }
]
</pre>

<h2><a id="Applications using API" name="Applications using API">Applications using the API</a></h2>

These applications use the API already:
<ul>
  <li>Metron <a href="http://metro.fi/paakaupunkiseutu/fiksaus/">Pitäiskö fiksata</a> - palvelu</li>
  <li><a href="http://korjaakaupunki.fi/">Korjaa kaupunki</a></li>
  <li><a href="https://fi.nearhood.net/">Nearhood</a> -paikallisuutispalvelu</li>
  <li><a href="https://itunes.apple.com/us/app/georeporter/id487304759">GeoReporter</a> iPhone Application</li>
  <li>Mobile Trouble Shooter <a href="http://www.windowsphone.com/en-us/store/app/mts/d941bf31-f5b6-4bb1-bf06-a27b1987bbea">Windows</a> and <a href="https://play.google.com/store/apps/details?id=com.smarts.pta&hl=en">Android</a> phone applications</li>
  <li><a href="http://fisuverkko.fi">Fisuverkko</a> - Kalasatama neighborhood website</li>
  <li><a href="http://helppoliikkua.fi/i">Helppo liikkua</a> - accessibility website</li>
</ul>
<h2><a id="FAQ" name="FAQ">Frequently asked questions</a></h2>

<a href="http://dev.hel.fi/node/82">Answers to Frequently Asked Questions</a>
